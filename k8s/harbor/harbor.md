# helm安装harbor
## 安装
```
helm install --name frm-harbor harbor/harbor --namespace=harbor --set expose.tls.enabled=true \
--set expose.ingress.hosts.core=repository.parkingwang.com --set expose.ingress.hosts.notary=notary.irains.com.cn \
--set externalURL=https://repository.parkingwang.com  \
--set expose.tls.secretName=tls-secret \
--set persistence.persistentVolumeClaim.registry.storageClass=rook-ceph-block \
--set persistence.persistentVolumeClaim.chartmuseum.storageClass=rook-ceph-block \
--set persistence.persistentVolumeClaim.jobservice.storageClass=rook-ceph-block \
--set persistence.persistentVolumeClaim.database.storageClass=rook-ceph-block \
--set persistence.persistentVolumeClaim.redis.storageClass=rook-ceph-block    \
--set harborAdminPassword=iRain2018
```

## 卸载
```
helm delete frm-harbor --purge=true
```

> 参考：
- [1. 官方文档](https://github.com/goharbor/harbor-helm)


openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout tls.key -out tls.crt -subj "/CN=traefik-ui.srv.irains.com.cn"
kubectl -n kube-system create secret tls traefik-ui-tls-cert --key=tls.key --cert=tls.crt

```
apiVersion: v1
data:  
  ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR1VENDQXFHZ0F3SUJBZ0lKQVBJZEpiMFJkd2h6TUEwR0NTcUdTSWIzRFFFQkN3VUFNSE14Q3pBSkJnTlYKQkFZVEFrTk9NUkF3RGdZRFZRUUlEQWRVYVdGdWFtbHVNUkF3RGdZRFZRUUhEQWRVYVdGdWFtbHVNUlV3RXdZRApWUVFLREF4RFNFbE9RVk5UVENCSmJtTXhLVEFuQmdOVkJBTU1JRU5JU1U1QlUxTk1JRU5sY25ScFptbGpZWFJwCmIyNGdRWFYwYUc5eWFYUjVNQjRYRFRFMk1EZ3lOakF5TXpBek0xb1hEVFEwTURReE5qQXlNekF6TTFvd2N6RUwKTUFrR0ExVUVCaE1DUTA0eEVEQU9CZ05WQkFnTUIxUnBZVzVxYVc0eEVEQU9CZ05WQkFjTUIxUnBZVzVxYVc0eApGVEFUQmdOVkJBb01ERU5JU1U1QlUxTk1JRWx1WXpFcE1DY0dBMVVFQXd3Z1EwaEpUa0ZUVTB3Z1EyVnlkR2xtCmFXTmhkR2x2YmlCQmRYUm9iM0pwZEhrd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUIKQVFDdkZOc0tHbFdBL3o3czFjaTBRa3pvQUNzMktsVUZ2RVJvU1NEbDc0aURnUnJSZ3pUcU56blpHNHpQeFVtVgowSWprQ282ZDI5N1NuM3BaYStUamorSHZ5enFKZzcyTjJqZjBUb0NiTHh2QStOc25QQ0hqS2s1MlI0akE2ZitzCkdkR3cyNXhlMUtTVlU3RlVPUFlHcGJrRytLN0hIWitNQkNza3V0anRidmJWUjg1YXh5N2R6bTVSNVh0YWgySEMKNzgzYXplaWNKTjdobVZORWVYVnpPdWp6MEFRVnZNVUc2UTRReFV1cndjbU1uek45SDJYVkN2Mjg3ZHJ0ZnpkcgpQQnVkTGZrcG5KL0ZBRFEyVWJlRG1BZG5Zd256YVNtTzkzVjZONjRRaExyNG9YVzhxcGxkMkJNRVY0K0QvU3IyCjRWZytjRkxBZ0JUV3VBSXRDR1N3Q1pqQkFnTUJBQUdqVURCT01CMEdBMVVkRGdRV0JCUmNIeVA2eU9FaE1jTFkKTi9hSS9OSnZ3bFJETXpBZkJnTlZIU01FR0RBV2dCUmNIeVA2eU9FaE1jTFlOL2FJL05KdndsUkRNekFNQmdOVgpIUk1FQlRBREFRSC9NQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUI5OEhyVkcreERzT3FONXI4alExWXZGaCs0CmZkV25rZXNyNHF1RS9oTmRUQWZVcUdjaW0zcFg4Zy9OQlh3aytZbktFY1MwZCtnd0c4dURQWnBEVHVEWmh5ZzQKU0Q0Q25pdUxTOFhEZWc4eFRxQ3dpRDFwQjlDUDZ4bTVSVVd3K210MlZTTmVxODVyS0J3NXJKUXpMT1NnaGs4eApFSDhGZWswdGJycEN3RWkzRVM4cXl3cUQzUUNaM1dYUk12dXNZRzJIclNTb2F2V3F2YWFFN1pvLzBwNEtUd0kvCnlsYlFJajdsZ0liNGhLMmprbktxSzJQTzA4cjZUdEZZQnNhUi9jaUw5OUxVc2J6d2xnSFBtQ0d6cHpJTFJBeXEKVXlPczdxMFBHZXArOXEyR3E0dE1JVng2NE55LzZhQmF1bUxLRkxvZHV1dElINXJVemFmYVI0Yk5IZWlLCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K 
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQrVENDQXVHZ0F3SUJBZ0lDTEtBd0RRWUpLb1pJaHZjTkFRRUxCUUF3Y3pFTE1Ba0dBMVVFQmhNQ1EwNHgKRURBT0JnTlZCQWdNQjFScFlXNXFhVzR4RURBT0JnTlZCQWNNQjFScFlXNXFhVzR4RlRBVEJnTlZCQW9NREVOSQpTVTVCVTFOTUlFbHVZekVwTUNjR0ExVUVBd3dnUTBoSlRrRlRVMHdnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvCmIzSnBkSGt3SGhjTk1Ua3dOekE0TURFeU9EVTFXaGNOTWpBd056QTNNREV5T0RVMVdqQ0JpekVMTUFrR0ExVUUKQmhNQ1EwNHhEekFOQmdOVkJBZ01Cbk5vWVc1NGFURU9NQXdHQTFVRUNnd0ZhWEpoYVc0eEREQUtCZ05WQkFzTQpBMFpTVFRFak1DRUdBMVVFQXd3YWNtVndiM05wZEc5eWVTNXdZWEpyYVc1bmQyRnVaeTVqYjIweEtEQW1CZ2txCmhraUc5dzBCQ1FFV0dYcG9ZVzVuY0dWdVowQndZWEpyYVc1bmQyRnVaeTVqYjIwd2dnRWlNQTBHQ1NxR1NJYjMKRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFEUklpSmZib3pQNWI4OGZwWEVEZVM2UkpDM2lFMkNCN3p6YzIxZAppQXNRRnM1aEhyUzB1dTF3dHI4ZzB6UWN4ZmRNTzcwazVNM2VSZW5sM0ZzYW5iZnZVR2RTSDNwM01SNHBQUW4zCko2VE5DR0FhMWVpOUZFR3BvcEpQcVNJWktSZVd2SVlCWGNid1ZEVEJkTkRpenBzaEx3Vk1aOElLMUhKcTI0VU8KbUk2MVY5c3FOTSt3TXFiL2kwYWJMbXZLYk9mbkk3aWJoQ1E5Ty9FelNMOWNBbWttNlNnQ3ZwcW01bGhhcVM5aQpRbTZJUWZwK21WNFhwTGlEcGYzVE9lTTB2NjB6elJxRXNMVHFMUHN2RmZVVzI4aXh3UVUrSkZyZDM1dWJzYjVrCjVsa3U2SjFZeFU2M2d5bW9SdjM5ZWpVWjRpbnJFTmhuY3VwbmFPbmZxdEZqQkg4aEFnTUJBQUdqZmpCOE1Ba0cKQTFVZEV3UUNNQUF3THdZSllJWklBWWI0UWdFTkJDSVdJRU5JU1U1QlUxTk1JRU5sY25ScFptbGpZWFJwYjI0ZwpRWFYwYUc5eWFYUjVNQjBHQTFVZERnUVdCQlNuSDJ5d0J0VE5XZnNVQWV0WXhBV2dPeWVSMkRBZkJnTlZIU01FCkdEQVdnQlJjSHlQNnlPRWhNY0xZTi9hSS9OSnZ3bFJETXpBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQUZRalUKUFFjR3RkbVluTENTaGtpM3BDazBlUnNmeTNHR2xBVE00cm4wZlhkNGhnRisxVG94d2NrWkZhQkc0MGI0WkV1RwpvL004T3YrVEdMeno0eTdhK1BKcnlUWFlyMHdqOElLUUJZTFpNNU9mOFJ3dmZhQlJpMzY3UkE2cExYanp3MUFNCnFFUUxnVE9aeXFNMktCVWJyOGxBSzFCeWZyMUdMMS9XdklqL1ZpSmdPVjBHSk1uYTJ0S3JDTW9PZ3hMUzlkNGwKOTUvaEo0TUhWMDNrZGpmQ1J0SzBMR0VzbzdQY3lQZFYvWGcrVXdOQ3p4RGdlQkR6eENwVTg1ZCtqK3QxQW1hbQpMcXlnU0xCQjN6emRkc1dtTkIvMHdocmdOQ0hHaVNiY0FrMHBwY0NQaXdRT3F3Qlh6bkxGWG1nSGN0SXE0T2lECjBLaWI0M09IZ29JYzVvRjQzdz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0= 
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRRFJJaUpmYm96UDViODgKZnBYRURlUzZSSkMzaUUyQ0I3enpjMjFkaUFzUUZzNWhIclMwdXUxd3RyOGcwelFjeGZkTU83MGs1TTNlUmVubAozRnNhbmJmdlVHZFNIM3AzTVI0cFBRbjNKNlROQ0dBYTFlaTlGRUdwb3BKUHFTSVpLUmVXdklZQlhjYndWRFRCCmRORGl6cHNoTHdWTVo4SUsxSEpxMjRVT21JNjFWOXNxTk0rd01xYi9pMGFiTG12S2JPZm5JN2liaENROU8vRXoKU0w5Y0Fta202U2dDdnBxbTVsaGFxUzlpUW02SVFmcCttVjRYcExpRHBmM1RPZU0wdjYwenpScUVzTFRxTFBzdgpGZlVXMjhpeHdRVStKRnJkMzV1YnNiNWs1bGt1NkoxWXhVNjNneW1vUnYzOWVqVVo0aW5yRU5obmN1cG5hT25mCnF0RmpCSDhoQWdNQkFBRUNnZ0VCQUxOS1dUK0piaXo1b1RhQ3EzRFdIR1pZUzkwY2ZKNWlkZW9jNWdET2xmVm8KSit4NVA2REZ0TFB4NSsrRFFlVDlEeU1LLy8vMkxFeEhrZHVmUzNlSkNWeWdpTU9OK3hiZVJDWkVqeHVWb0NLcQo4SUZ4SzhPVjd5azRGOGsxamVjV0pJUDFBY21BRlFLS25tUFAreGpHMlpYY1V1V0srbjhBWFVzaEFYUmU4OUdnCmdGTlJLMitVck1kdGlRUE91MFhGN0wvYUppVU5hN1dzVlR1L0kzVjRlSEl4Z1BQdURod0NqbkdGSkZ3WWJ2UG4KaUl2bHVRWmxJanp5empNVWhSZnIvSWJCZVh6SmFmVjJCaGJuY2RiMTdBUER3Y083U05GTFhwaXdmQWdic295NAptOTIzd1N4YzFjUnd6VzcxWm9qVUNmbGVITmhCMzJNV2FkMENnMlBmaW5VQ2dZRUE4UE1DV3kybGk2L0txVWl0CkJFN0NWS01mSXYxaDdCaWNOL3BNZ05EdzM2ZXdmNEhObWN4cGNWQ0dPVnVGYkc0V1M1M0RENHgyNmpZVUFHK08KTHBKaXFOdU5BSGFsd0lmNmJCSmwxeVhOYmFTMWg4V1hwWlgrMlQyVElNVTU5YndCT29rd2VHZHl2dVdwR1NIcQpjRXZGdzdJRlZxYzhHSXp1RHltTDgyU3RhYU1DZ1lFQTNqSmNTdnJQeXN1YllMaU9TT1RSUlNwMkx4eXJ0OWxICmpJaUdPRFVFWVBBSWFpWFBMbUZuV25QSExZM0ZvMFRTRnNzb0c1Zit5M3R6NlpqU2QwV0JDSGdzSUNIQ09PdlIKZ0V1SXdFUG10TWtnNnBXemZDVk8wYXJ1UE1WTDc2UmZLQ0hpaS9GclJtOS9LOEJjWElwZmpDcWVleHhLYWUxZgpIWWRiVlVBV3lHc0NnWUVBNDlwNk5PMGlxc2tQbGl4UzZVcnRmSXBSakk0ZXh0eXpCa0NkamdlSWNZZ3JZVGpICnpCUkE5bFpXeC9EamFKbG1YaFdQZTZteVhtUExZR29lQTY2TXUrLzdGQ0FmT01XZUxBcnQ0Wm91L091UWV4ZUIKQTZhbnZKbjlBelZmVFNGLzYvSUdNeVpvblZ1aklGQXhXZ1pkdTJVaXBVSTZrMkRhVXQ1UUtWZmdvWThDZ1lBdApSMS90VzV6NmUzRkhUWFNaUUIreEU0MFAzcXpUZ3pDRVg5SFNKR09uQ1dMOWxvVFlzN3FuQVE3bXBveE8wQmhyCjBxeHlxdytlRWFNMlNCRWpnd05mWVhYRWVueWtzdEYzYm0wSW1RMnJhNDBNb01MNW1uU3NYME83R0kxMzRTd08KOXBDKzZjeHRodzBJTW1QZjY4YTZ2bmliSjlHMk1rdityWFdjTXJveHp3S0JnQ0dZVXFMMDl6bWRINzJES3ZlWQpBMktHN1A0YjhDdjgxT3RYcUxxTDlPNGlCY215dFk0ZDFIeG1nYUVkZDYyTzUxZDIwbi91RjM4OUlCLzErZlgzCkQ2cEtGb3lPcWZITDdRN3BySmQrenhIaWlsb3dRdXBJOHV5OTN6ZFp4Snp1K29Xb0tsU2tkeDlDM0haWldORUEKR1V6cksyUCtkMGdDSm56eGxmZ2M2WHJKCi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
kind: Secret
metadata:
  name: tls-secret
  namespace: harbor
type: kubernetes.io/tls
```
